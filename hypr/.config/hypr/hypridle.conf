###############################################################
# HYPRIDLE – CONFIG IDEAL (com boas práticas e estabilidade)
###############################################################

#########################
# GENERAL
#########################
general {
    # Comando para bloquear a tela.
    # Só executa se o hyprlock NÃO estiver rodando (evita duplicar).
    lock_cmd = bash -c 'pidof hyprlock >/dev/null || hyprlock'

    # Antes de suspender → bloqueia a sessão
    before_sleep_cmd = loginctl lock-session

    # Ao voltar da suspensão → liga o DPMS (liga o monitor)
    after_sleep_cmd = hyprctl dispatch dpms on
}

###############################################################
# LISTENER 1 — TELA BLOQUEADA APÓS 4 MINUTOS (240s)
###############################################################
listener {
    timeout = 240

    # Ao expirar → força layout padrão + trava a tela se não estiver travada
    on-timeout = bash -c '
        hyprctl switchxkblayout at-translated-set-2-keyboard 0;
        pidof hyprlock >/dev/null || hyprlock
    '

    # Quando voltar da atividade → liga o DPMS para garantir imagem
    on-resume = hyprctl dispatch dpms on
}

###############################################################
# LISTENER 2 — REDUZIR BRILHO APÓS 10 MINUTOS (600s)
###############################################################
listener {
    timeout = 600

    # Salva brilho atual (-s) e reduz para 10%
    on-timeout = brightnessctl -s set 10

    # Restaura o brilho salvo (-r)
    on-resume = brightnessctl -r
}

###############################################################
# LISTENER 3 — SUSPENDER APÓS 11 MINUTOS (660s)
###############################################################
listener {
    timeout = 660

    # Hiberna/suspende o sistema
    on-timeout = systemctl suspend
}
